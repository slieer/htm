<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script>
        {
            function loadImg(src){
                return new Promise((resolve, reject) => {
                    let img = document.createElement('img');
                    img.src = src;
                    img.onload = function(){
                        resolve(img);
                    };
                    img.onerror = function(){
                        reject(error);
                    }
                });
            }

            function showImg(img){
                document.body.appendChild(img);
            }

            loadImg('http://img5.imgtn.bdimg.com/it/u=2873303569,1224067546&fm=27&gp=0.jpg').then(showImg);
        }
        {
            function loadImg(src){
                return new Promise((resolve, reject)=>{
                    let img = document.createElement('img');
                    img.src = src;
                    img.onload = function(){
                        resolve(img);
                    };
                    img.onerror = function(){
                        reject(err);
                    };
                });
            }

            function showImg(img){
                document.body.appendChild(img);
            }

            Promise.race([
                loadImg('https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=1517420881,1284406776&fm=27&gp=0.jpg',),
                loadImg('https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=2546506461,4214746746&fm=11&gp=0.jpg'),
                loadImg('https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=1517420881,1284406776&fm=27&gp=0.jpg')
            ]).then(showImg);
        }
        {
            function loadImg(src){
                return new Promise((resolve, reject) => {
                    let img = document.createElement('img');
                    img.src = src;
                    img.onload = function(){
                        resolve(img);
                    };
                    img.onerror = function(){
                        reject();
                    };
                });
            }

            function showImg(img){
                document.body.appendChild(img);
            }

            loadImg('https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=227953490,3054069314&fm=27&gp=0.jpg').then(showImg);
        }
        {
            //所有图片加载完再加载页面
            function loadImg(src){
                return new Promise((resolve, reject)=>{
                    let img = document.createElement('img');
                    img.src = src;
                    img.onload=function(){
                        resolve(img);
                    };
                    img.onerror=function(){
                        reject(err);
                    };
                });
            }
            function showImgs(imgs){
                imgs.forEach(img => {
                    document.body.appendChild(img);
                });
            }

            Promise.all([
                loadImg('https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=49366202,632101467&fm=27&gp=0.jpg'),
                loadImg('https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=594559231,2167829292&fm=27&gp=0.jpg'),
                loadImg('https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1501729109,4046516680&fm=27&gp=0.jpg')
            ]).then(showImgs);
        }
        {
            let ajax = function(num){
                console.log('执行3');
                return new Promise(function(resolve, reject){
                    if (num>3){
                        resolve();
                    }else{
                        reject();
                    }
                });
            }; 

            ajax(3).then(function(){
                console.log('成功');
            }).catch(function(){
                console.log('失败');
            });
        }
        {
            let ajax = function(){
                console.log('执行2');
                return new Promise(function(resolve, reject){
                    setTimeout(() => {
                        resolve();
                    }, 1000);
                });
            };     

            ajax().then(function(){
                console.log('Promise', 'timer2');
            });
        }
        {
            let ajax = function(callBack){
                console.log('执行了');
                setTimeout(() => {
                    callBack&&callBack.call();
                }, 1000);
            };

            ajax(function(){
                console.log('timeout1');
            });
        }        
    </script>
</body>
</html>