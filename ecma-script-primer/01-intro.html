<!DOCTYPE html>
<html>

<head>
    <!--规定异步执行脚本（仅适用于外部脚本）。
        <script src="myScript.js" async></script>
        defer 规定当页面已完成解析后，执行脚本（仅适用于外部脚本）。
        <script src="myOtherScript.js" defer></script> 
    -->
    <script src="https://cdn.bootcdn.net/ajax/libs/log4javascript/1.4.9/log4javascript.js"></script>
</head>

<body>
    <div>
        hi
    </div>
    <script>
        var log = log4javascript.getDefaultLogger();
        log.info('log4javascript print log test');
        let arr = [1, 3, 4, 6].map(t => t + '_');
        //object
        log.info('typeof arr is object:' + typeof arr + ",arr:" + arr);

        let sentences = ["JavaScript Array flatMap()", " ", "is", " ", "Awesome"];
        log.info("two-dimensional array：" + sentences.map(s => s.split(' ')));
        log.info('flat to 1-dim array:' + sentences.map(s => s.split(' ').flat().filter(t => t)));
        log.info('flat to 1-dim array 1:' + sentences.flatMap(s => s.split(' ')));

        let _2_dim_arr = [[1, 2, 3], [1, 2, 3], [1, 2, 3], [1, 2, 3], [1, 2, 3], [1, 2, 3], [1, 2, 3], [1, 2, 3]];
        log.info('_2_dim_arr:' + _2_dim_arr.flat())

        let cart = [{
            name: 'Smartphone',
            qty: 2,
            price: 500,
            freeOfCharge: false
        },
        {
            name: 'Tablet',
            qty: 1,
            price: 800,
            freeOfCharge: false
        }
        ];

        //当客户将智能手机添加到购物车时，我们可以使用 flatMap() 方法将屏幕保护膜添加到购物车
        let newCart = cart.flatMap(
            (item) => {
                if (item.name === 'Smartphone') {
                    return [item, {
                        name: 'Screen Protector',
                        qty: item.qty,
                        price: 5,
                        freeOfCharge: true
                    }]
                } else {
                    return [item];
                }
            }
        ).map(t => JSON.stringify(t));
        log.info(newCart);

        //ES2020 在语言标准的层面，引入globalThis作为顶层对象。也就是说，任何环境下，globalThis都是存在的，都可以从它拿到顶层对象，指向全局环境下的this。
        log.info(globalThis);
    </script>
</body>

</html>